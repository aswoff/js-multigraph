<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src&#x2F;core&#x2F;legend.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/ArrayData.html">ArrayData</a></li>
            
                <li><a href="..&#x2F;classes/axisBinding.html">axisBinding</a></li>
            
                <li><a href="..&#x2F;classes/EventEmitter.html">EventEmitter</a></li>
            
                <li><a href="..&#x2F;classes/Legend.html">Legend</a></li>
            
                <li><a href="..&#x2F;classes/Text.html">Text</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src&#x2F;core&#x2F;legend.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
window.multigraph.util.namespace(&quot;window.multigraph.core&quot;, function (ns) {
    &quot;use strict&quot;;

    &#x2F;**
        @class Legend
        @constructor
        @param {boolean} visible
        @param {point} base
        @param {point} anchor
        @param {point} position 
        @param frame - plot or padding
        @param {rgb} color 
        @param {rgb} bordercolor 
        @param {number} opacity 
        @param {integer} border
        @param {integer} rows
        @param {integer} columns
        @param {integer} cornerradius
        @param {integer} padding
        @param {icon} icon
        @param {plot} plots
        @param {integer} [iconOffset=5]
        @param {integer} [labelOffset=5] 
        @param {integer} [labelEnding=15]
        @param width
        @param height
        @param x
        @param y
        @param blockWidth
        @param blockHeight
        @param maxLabelWidth
        @param maxLabelHeight
        @requires point.js
        @requires rgb_color.js
        @requires validation-functions.js
        @requires plot.js
        @requires icon.js
    *&#x2F;

    var Icon,
        Legend,
        defaultValues = window.multigraph.utilityFunctions.getDefaultValuesFromXSD(),
        attributes = window.multigraph.utilityFunctions.getKeys(defaultValues.legend);

    Legend = new window.jermaine.Model( &quot;Legend&quot;, function () {
        this.hasA(&quot;visible&quot;).which.isA(&quot;boolean&quot;);
        this.hasA(&quot;base&quot;).which.validatesWith(function (base) {
            return base instanceof window.multigraph.math.Point;
        });
        this.hasAn(&quot;anchor&quot;).which.validatesWith(function (anchor) {
            return anchor instanceof window.multigraph.math.Point;
        });
        this.hasA(&quot;position&quot;).which.validatesWith(function (position) {
            return position instanceof window.multigraph.math.Point;
        });
        this.hasA(&quot;frame&quot;).which.validatesWith(function (frame) {
            return frame === &quot;plot&quot; || frame === &quot;padding&quot;;
        });
        this.hasA(&quot;color&quot;).which.validatesWith(function (color) {
            return color instanceof window.multigraph.math.RGBColor;
        });
        this.hasA(&quot;bordercolor&quot;).which.validatesWith(function (bordercolor) {
            return bordercolor instanceof window.multigraph.math.RGBColor;
        });
        this.hasA(&quot;opacity&quot;).which.validatesWith(function (opacity) {
            return window.multigraph.utilityFunctions.validateNumberRange(opacity, 0.0, 1.0);
        });
        this.hasA(&quot;border&quot;).which.isA(&quot;integer&quot;);
        this.hasA(&quot;rows&quot;).which.isA(&quot;integer&quot;).and.isGreaterThan(0);
        this.hasA(&quot;columns&quot;).which.isA(&quot;integer&quot;).and.isGreaterThan(0);
        this.hasA(&quot;cornerradius&quot;).which.isA(&quot;integer&quot;);
        this.hasA(&quot;padding&quot;).which.isA(&quot;integer&quot;);
        this.hasAn(&quot;icon&quot;).which.validatesWith(function (icon) {
            return icon instanceof ns.Icon;
        });

        this.hasMany(&quot;plots&quot;).which.validatesWith(function (plot) {
            return plot instanceof ns.Plot;
        });

        this.hasA(&quot;iconOffset&quot;).which.defaultsTo(5);
        this.hasA(&quot;labelOffset&quot;).which.defaultsTo(5);
        this.hasA(&quot;labelEnding&quot;).which.defaultsTo(15);

        this.hasA(&quot;width&quot;);
        this.hasA(&quot;height&quot;);

        this.hasA(&quot;x&quot;);
        this.hasA(&quot;y&quot;);

        this.hasA(&quot;blockWidth&quot;);
        this.hasA(&quot;blockHeight&quot;);

        this.hasA(&quot;maxLabelWidth&quot;);
        this.hasA(&quot;maxLabelHeight&quot;);

        &#x2F;**
            Initializes the legend
            @method Legend#initializeGeometry
            @param graph
            @return {boolean} visible
            @return widths
            @return heights
            @todo Find out whether or not padding needs to be taken into consideration.
        *&#x2F;
        this.respondsTo(&quot;initializeGeometry&quot;, function (graph, graphicsContext) {
            var widths = [],
                heights = [],
                label,
                i;

            if (this.visible() === false) {
                return;
            }

            for (i = 0; i &lt; graph.plots().size(); i++) {
                if (graph.plots().at(i).legend() &amp;&amp; graph.plots().at(i).legend().visible() !== false) {
                    this.plots().add(graph.plots().at(i));
                }
            }

            if (this.visible() === undefined) {
                if (this.plots().size() &gt; 1) {
                    this.visible(true);
                } else {
                    this.visible(false);
                    return;
                }
            }

            &#x2F;&#x2F; if neither rows nor cols is specified, default to 1 col
            if (this.rows() === undefined &amp;&amp; this.columns() === undefined) {
                this.columns(1);
            }

            &#x2F;&#x2F; if only one of rows&#x2F;cols is specified, compute the other
            if (this.columns() === undefined) {
                this.columns(parseInt(this.plots().size() &#x2F; this.rows() + ( (this.plots().size() % this.rows()) &gt; 0 ? 1 : 0 ), 10));
            } else if  (this.rows() === undefined) {
                this.rows(parseInt(this.plots().size() &#x2F; this.columns() + ( (this.plots().size() % this.columns()) &gt; 0 ? 1 : 0 ), 10));
            }

            for (i = 0; i &lt; this.plots().size(); i++) {
                label = this.plots().at(i).legend().label();
                if (label !== undefined) {
                    label.initializeGeometry(graphicsContext);
                    widths.push(label.rotatedWidth());
                    heights.push(label.rotatedHeight());
                }
            }

            widths.sort(function (a, b) {
                return b - a;
            });
            heights.sort(function (a, b) {
                return b - a;
            });
            this.maxLabelWidth(widths[0]);
            this.maxLabelHeight(Math.max(heights[0], this.icon().height()));

            this.blockWidth(this.iconOffset() + this.icon().width() + this.labelOffset() + this.maxLabelWidth() + this.labelEnding());
            this.blockHeight(this.iconOffset() + this.maxLabelHeight());

&#x2F;&#x2F; TODO: find out whether or not padding needs to be taken into consideration
            this.width((2 * this.border()) + (this.columns() * this.blockWidth()));
            this.height((2 * this.border()) + (this.rows() * this.blockHeight()) + this.iconOffset());

            if (this.frame() === &quot;padding&quot;) {
                this.x(((this.base().x() + 1) * graph.paddingBox().width()&#x2F;2) - ((this.anchor().x() + 1) * this.width()&#x2F;2) + this.position().x());
                this.y(((this.base().y() + 1) * graph.paddingBox().height()&#x2F;2) - ((this.anchor().y() + 1) * this.height()&#x2F;2) + this.position().y());
            } else {
                this.x(((this.base().x() + 1) * graph.plotBox().width()&#x2F;2) - ((this.anchor().x() + 1) * this.width()&#x2F;2) + this.position().x());
                this.y(((this.base().y() + 1) * graph.plotBox().height()&#x2F;2) - ((this.anchor().y() + 1) * this.height()&#x2F;2) + this.position().y());
            }

        });

        &#x2F;**
            Draws the legend
            @method Legend#render
            @param graphicsContext
           
        *&#x2F;
        this.respondsTo(&quot;render&quot;, function (graphicsContext) {
            var blockx, blocky,
                iconx, icony,
                labelx, labely,
                plotCount = 0,
                r, c;

            if (this.visible() === false) {
                return;
            }

            &#x2F;&#x2F; preform any neccesary setup
            this.begin(graphicsContext);

            &#x2F;&#x2F; Draw the legend box
            this.renderLegend(graphicsContext);

            for (r = 0; r &lt; this.rows(); r++) {
                if (plotCount &gt;= this.plots().size()) {
                    break;
                }
                blocky = this.border() + ((this.rows() - r - 1) * this.blockHeight());
                icony  = blocky + this.iconOffset();
                labely = icony;
                for (c = 0; c &lt; this.columns(); c++) {
                    if (plotCount &gt;= this.plots().size()) {
                        break;
                    }
                    blockx = this.border() + (c * this.blockWidth());
                    iconx  = blockx + this.iconOffset();
                    labelx = iconx + this.icon().width() + this.labelOffset();

                    &#x2F;&#x2F; Draw the icon
                    this.plots().at(plotCount).renderer().renderLegendIcon(graphicsContext, iconx, icony, this.icon(), this.opacity());
                    
                    &#x2F;&#x2F; Draw the icon border
                    if (this.icon().border() &gt; 0) {
                        this.icon().renderBorder(graphicsContext, iconx, icony, this.opacity());
                    }
                    
                    &#x2F;&#x2F; Write the text
                    this.renderLabel(this.plots().at(plotCount).legend().label(), graphicsContext, labelx, labely);

                    plotCount++;
                }
            }

            &#x2F;&#x2F; preform any neccesary steps at the end of rendering
            this.end(graphicsContext);

        });

&#x2F;&#x2F;        &#x2F;**
&#x2F;&#x2F;            Measure the width of the text
&#x2F;&#x2F;            @method Legend#measureLabelWidth
&#x2F;&#x2F;            @param {string}
&#x2F;&#x2F;            @return length
&#x2F;&#x2F;            @todo Replace this function with one that properly measure the width of text.  This will most likely be done in an abstract text class which has knowledge of the rendering environment.
&#x2F;&#x2F;        *&#x2F;
&#x2F;&#x2F;
&#x2F;&#x2F;
&#x2F;&#x2F;&#x2F;&#x2F; TODO: replace these functions with ones that properly measure the width&#x2F;height of text.
&#x2F;&#x2F;&#x2F;&#x2F;       This will most likely be done in an abstract text class which has knowledge of the
&#x2F;&#x2F;&#x2F;&#x2F;       rendering environment.
&#x2F;&#x2F;        this.respondsTo(&quot;measureLabelWidth&quot;, function (string) {
&#x2F;&#x2F;                &#x2F;&#x2F; Graphics drivers should replace this method with an actual implementation; this
&#x2F;&#x2F;                &#x2F;&#x2F; is just a placeholder.  The implementation should return the width, in pixels,
&#x2F;&#x2F;                &#x2F;&#x2F; of the given string.  Of course this is dependent on font choice, size, etc,
&#x2F;&#x2F;                &#x2F;&#x2F; but we gloss over that at the moment.  Just return the width of the string
&#x2F;&#x2F;                &#x2F;&#x2F; using some reasonable default font for now.  Later on, we&#x27;ll modify this
&#x2F;&#x2F;                &#x2F;&#x2F; function to use font information.
&#x2F;&#x2F;                return string.length*30;
&#x2F;&#x2F;        });
&#x2F;&#x2F;
&#x2F;&#x2F;
&#x2F;&#x2F;
&#x2F;&#x2F;        &#x2F;**
&#x2F;&#x2F;            Measure the height of the text
&#x2F;&#x2F;            @method Legend#measureLabelHeight
&#x2F;&#x2F;            @param {string}
&#x2F;&#x2F;            @return height
&#x2F;&#x2F;            @todo Replace this function with one that properly measures the height of text.  This will most likely be done in an abstract text class which has knowledge of the rendering environment.
&#x2F;&#x2F;        *&#x2F;
&#x2F;&#x2F;        this.respondsTo(&quot;measureLabelHeight&quot;, function (string) {
&#x2F;&#x2F;                &#x2F;&#x2F; Graphics drivers should replace this method with an actual implementation; this
&#x2F;&#x2F;                &#x2F;&#x2F; is just a placeholder.  The implementation should return the height, in pixels,
&#x2F;&#x2F;                &#x2F;&#x2F; of the given string.  Of course this is dependent on font choice, size, etc,
&#x2F;&#x2F;                &#x2F;&#x2F; but we gloss over that at the moment.  Just return the height of the string
&#x2F;&#x2F;                &#x2F;&#x2F; using some reasonable default font for now.  Later on, we&#x27;ll modify this
&#x2F;&#x2F;                &#x2F;&#x2F; function to use font information.
&#x2F;&#x2F;                return 12;
&#x2F;&#x2F;        });

        window.multigraph.utilityFunctions.insertDefaults(this, defaultValues.legend, attributes);
    });

    ns.Legend = Legend;

});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
